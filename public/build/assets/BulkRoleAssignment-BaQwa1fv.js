import{i as x,y as C,z as V,A as E,$ as I,B as j,h as w,D as M,c as d,o as r,a as k,w as D,b as s,g as $,p as _,F as g,q as y,t as n,E as q,x as U,G as A}from"./app-BDWkFCnl.js";import{_ as z}from"./AuthenticatedLayout-D2Pi0Ovw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"text-2xl font-bold text-gray-800"},H={class:"container mx-auto px-4 py-6"},O={class:"mb-8"},G=["value"],L={key:0,class:"flex gap-6 items-stretch"},Q={class:"flex-1 bg-white rounded-lg shadow-md border"},R={class:"bg-blue-600 text-white px-4 py-3 rounded-t-lg"},J={class:"font-semibold"},K={class:"p-4 h-96 overflow-y-auto"},P={class:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded"},T=["value"],W={class:"text-gray-700"},X={class:"flex flex-col justify-center gap-4 px-2"},Y=["disabled"],Z=["disabled"],ee={class:"flex-1 bg-white rounded-lg shadow-md border"},se={class:"bg-blue-600 text-white px-4 py-3 rounded-t-lg"},te={class:"font-semibold"},ae={class:"p-4 h-96 overflow-y-auto"},le={class:"flex items-center space-x-2 hover:bg-gray-50 p-2 rounded"},oe=["value"],ne={class:"text-gray-700"},ce={__name:"BulkRoleAssignment",props:{users:Array,allDatas:Array,assignedDatasByUser:Object,tableName:String,addUrl:String,removeUrl:String},setup(i){const v=i,l=x(null),c=x([]),u=x([]),b=C({});let m=null;Object.assign(b,v.assignedDatasByUser),V(()=>{S(),E(l,()=>{c.value=[],u.value=[]})});const S=()=>{const t=document.querySelector(".user-select");t&&(m=I(t).select2({placeholder:"Seleccione un usuario",width:"100%",allowClear:!0}).on("change",e=>{l.value=e.target.value}))};j(()=>{m&&m.select2("destroy")});const h=w(()=>{var t;return l.value?((t=b[l.value])==null?void 0:t.map(e=>({id:e.id,name:e.name})))||[]:[]}),f=w(()=>{const t=h.value.map(e=>e.id);return v.allDatas.filter(e=>!t.includes(e.id)&&e.id!==void 0)}),B=async()=>{var t,e;try{const o=await A.post(v.addUrl,{user_id:l.value,datas:c.value});b[l.value]=o.data.data[l.value]||[],c.value=[]}catch(o){alert("Error: "+((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||o.message)}},N=async()=>{var t,e;try{const o=await A.post(v.removeUrl,{user_id:l.value,datas:u.value});b[l.value]=o.data.data[l.value]||[],u.value=[]}catch(o){alert("Error: "+((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||o.message)}};return(t,e)=>{const o=M("Head");return r(),d(g,null,[k(o,{title:`Asignación de ${i.tableName}`},null,8,["title"]),k(z,null,{header:D(()=>[s("h1",F," Asignación de "+n(i.tableName),1)]),default:D(()=>[s("div",H,[s("div",O,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Seleccionar usuario: ",-1)),_(s("select",{class:"user-select w-full","onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a)},[e[3]||(e[3]=s("option",{value:null},null,-1)),(r(!0),d(g,null,y(i.users,a=>(r(),d("option",{key:a.id,value:a.id},n(a.username)+" (ID: "+n(a.id)+") ",9,G))),128))],512),[[q,l.value]])]),l.value?(r(),d("div",L,[s("div",Q,[s("div",R,[s("h3",J,n(i.tableName)+" disponibles ("+n(f.value.length)+") ",1)]),s("div",K,[(r(!0),d(g,null,y(f.value,a=>(r(),d("div",{key:a.id,class:"mb-2"},[s("label",P,[_(s("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":e[1]||(e[1]=p=>c.value=p),class:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300"},null,8,T),[[U,c.value]]),s("span",W,n(a.data),1)])]))),128))])]),s("div",X,[s("button",{onClick:B,disabled:!c.value.length,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Agregar → ",8,Y),s("button",{onClick:N,disabled:!u.value.length,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," ← Quitar ",8,Z)]),s("div",ee,[s("div",se,[s("h3",te,n(i.tableName)+" asignados ("+n(h.value.length)+") ",1)]),s("div",ae,[(r(!0),d(g,null,y(h.value,a=>(r(),d("div",{key:a.id,class:"mb-2"},[s("label",le,[_(s("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":e[2]||(e[2]=p=>u.value=p),class:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300"},null,8,oe),[[U,u.value]]),s("span",ne,n(a.name),1)])]))),128))])])])):$("",!0)])]),_:1})],64)}}};export{ce as default};
