import{a3 as h,K as V,$ as m,a6 as o}from"./reactivity.esm-bundler-BqKWhRsu.js";import{h as w,n as C,l as E,y as M,z as $,c as r,o as d,a as U,w as A,b as e,g as F,i as f,F as b,x as y,A as H,v as D,d as I,B as N}from"./app-BwqKRIuq.js";import{_ as j}from"./AuthenticatedLayout-BTmZFfCO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"p-4 bg-white rounded-lg shadow-xs"},K={class:"contenedor"},L={class:"mb-8"},O=["value"],Q={key:0,class:"flex gap-6 items-stretch"},T={class:"panel"},q={class:"panel-header"},G={class:"text-lg font-semibold"},J={class:"list-contenedor"},P={class:"flex items-center w-full cursor-pointer space-x-3"},R=["value"],W={class:"text-gray-700"},X={class:"transfer-buttons"},Y=["disabled"],Z=["disabled"],ee={class:"panel"},se={class:"panel-header"},ae={class:"text-lg font-semibold"},te={class:"list-contenedor"},le={class:"flex items-center w-full cursor-pointer space-x-3"},oe=["value"],ne={class:"text-gray-700"},ue={__name:"BulkUserEntitiesAssignment",props:{users:Array,allDatas:Array,assignedDatasByUser:Object,tableName:String,addUrl:String,removeUrl:String,totalAlumnos:Number},setup(i){const g=i,t=h(null),c=h([]),u=h([]),_=V({...g.assignedDatasByUser}),p=w(()=>t.value?_[t.value]||[]:[]),k=w(()=>{const n=p.value.map(s=>s.id);return g.allDatas.filter(s=>!n.includes(s.id))}),B=async()=>{var n,s;try{const l=await N.post(g.addUrl,{user_id:t.value,datas:c.value});_[t.value]=l.data.data[t.value],c.value=[]}catch(l){alert("Error al asignar: "+((s=(n=l.response)==null?void 0:n.data)==null?void 0:s.message)||l.message)}},S=async()=>{var n,s;try{const l=await N.post(g.removeUrl,{user_id:t.value,datas:u.value});_[t.value]=l.data.data[t.value],u.value=[]}catch(l){alert("Error al remover: "+((s=(n=l.response)==null?void 0:n.data)==null?void 0:s.message)||l.message)}},v=h(null);return C(()=>{m(v.value).select2(),m(v.value).on("change",function(){t.value=m(this).val()})}),E(t,n=>{m(v.value).val(n).trigger("change")}),M(()=>{m(v.value).select2("destroy")}),(n,s)=>{const l=$("Head");return d(),r(b,null,[U(l,{title:`Asignación de ${i.tableName}`},null,8,["title"]),U(j,null,{header:A(()=>[I(" Asignación de "+o(i.tableName),1)]),default:A(()=>[e("div",z,[e("div",K,[e("div",L,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Seleccionar usuario: ",-1)),f(e("select",{ref_key:"selectUser",ref:v,"onUpdate:modelValue":s[0]||(s[0]=a=>t.value=a),class:"select-style user-select"},[s[3]||(s[3]=e("option",{value:null},"-- Seleccione un usuario --",-1)),(d(!0),r(b,null,y(i.users,a=>(d(),r("option",{key:a.id,value:a.id},o(a.full_name)+" - "+o(a.username),9,O))),128))],512),[[H,t.value]])]),t.value?(d(),r("div",Q,[e("div",T,[e("div",q,[e("h3",G,o(i.tableName)+" disponibles ("+o(k.value.length)+")",1)]),e("div",J,[(d(!0),r(b,null,y(k.value,a=>(d(),r("div",{key:a.id,class:"list-item"},[e("label",P,[f(e("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":s[1]||(s[1]=x=>c.value=x),class:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300"},null,8,R),[[D,c.value]]),e("span",W,o(a.data)+" - ("+o(a.id)+")",1)])]))),128))])]),e("div",X,[e("button",{onClick:B,disabled:!c.value.length,class:"btn-action bg-emerald-600 hover:bg-emerald-700 text-white"}," Agregar → ",8,Y),e("button",{onClick:S,disabled:!u.value.length,class:"btn-action bg-rose-600 hover:bg-rose-700 text-white"}," ← Quitar ",8,Z)]),e("div",ee,[e("div",se,[e("h3",ae,o(i.tableName)+" asignados ("+o(p.value.length)+")",1)]),e("div",te,[(d(!0),r(b,null,y(p.value,a=>(d(),r("div",{key:a.id,class:"list-item"},[e("label",le,[f(e("input",{type:"checkbox",value:a.id,"onUpdate:modelValue":s[2]||(s[2]=x=>u.value=x),class:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-300"},null,8,oe),[[D,u.value]]),e("span",ne,o(a.name)+" - ("+o(a.id)+")",1)])]))),128))])])])):F("",!0)])])]),_:1})],64)}}};export{ue as default};
